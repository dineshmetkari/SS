package org.stackroute.service;

import static org.junit.Assert.*;

import java.io.IOException;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.Mock;
import org.mockito.MockitoAnnotations;
import org.springframework.amqp.AmqpException;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.test.context.web.WebAppConfiguration;

import com.stackroute.messaging.Producer;
import com.stackroute.messaging.Publish;
import com.stackroute.messaging.Receiver;
import com.stackroute.model.Model;
import com.stackroute.service.Service;

@RunWith(SpringRunner.class)
@SpringBootTest
@WebAppConfiguration
public class ServiceITTest {
	@Autowired
	private Receiver receive ;
	@Autowired
	private Model model;
	@Autowired
	private Service service;
	
	@Mock
	private Publish publish;
	
	@Before
	public void setupMock() throws AmqpException, IOException {
		MockitoAnnotations.initMocks(this);
		service.setPublish(publish);
	}
	
	@Test
	public void integtationTest() {
//		Arrange
		receive.receiveMessage("{\"domain\":\"Java\",\"concept\":\"Algorithm\",\"url\":\"https://www.javatpoint.com\",\"terms\": {\"Delete\":0,\"fundamental\":1}}");
		receive.receiveMessage("{\"domain\":\"Java\",\"concept\":\"Algorithm\",\"url\":\"https://www.javatpoint.com\",\"ImgCount\":128}");
		receive.receiveMessage("{\"domain\":\"Java\",\"concept\":\"Algorithm\",\"url\":\"https://www.javatpoint.com\",\"VideoCount\":2}");
		receive.receiveMessage("{\"domain\":\"Java\",\"concept\":\"Algorithm\",\"url\":\"https://www.javatpoint.com\",\"codecount\":5}");
	
	
	}

}
